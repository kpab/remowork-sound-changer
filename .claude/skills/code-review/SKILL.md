---
name: code-review
description: |
  コードレビューの手順とチェックリスト。
  12視点マトリックスレビュー（3ペルソナ × 4カテゴリ）を実施。
  発動キーワード: レビュー、review、チェック、確認
allowed-tools: Read, Grep, Glob
version: 1.1.0
updated: 2025-12-27
---

# Code Review

## 概要

機能完成時に実施するコードレビュー。
**12視点マトリックスレビュー**を使用して包括的にチェックする。

## 重要ルール

**開発完了後、git push 前に必ずこのレビューを実施すること。**
レビューをパスするまでプッシュは禁止。

## 使用タイミング

- 機能実装が完了した時
- リリース前の最終確認
- **git push の直前（必須）**

## 12視点マトリックスレビュー

3つのペルソナ × 4つのカテゴリ = 12視点

### ペルソナ

| ペルソナ | 役割 | 重視ポイント |
|----------|------|-------------|
| **Claude Code** | 技術実装者 | コード品質、パフォーマンス |
| **antigravity** | アーキテクト/セキュリティ | 設計、セキュリティ、ルール準拠 |
| **Claude AI** | ドキュメント/整合性 | 可読性、命名、ドキュメント |

### カテゴリ

| カテゴリ | 内容 |
|----------|------|
| **技術品質** | コード品質、エラーハンドリング |
| **セキュリティ** | CSP、XSS、権限 |
| **ドキュメント** | コメント、命名、自己文書化 |
| **UX** | ユーザー体験、フィードバック |

## レビュー結果テンプレート

```markdown
## 12視点マトリックスレビュー結果

**対象**: {機能名/ファイル}
**日時**: {YYYY-MM-DD}

### Claude Code 視点

| カテゴリ | 状態 | 詳細 |
|----------|------|------|
| 技術品質 | ✅/⚠️/❌ | Manifest V3準拠、エラーハンドリング、非同期処理 |
| セキュリティ | ✅/⚠️/❌ | eval()禁止、innerHTML注意 |
| ドキュメント | ✅/⚠️/❌ | console.log削除、コード整理 |
| UX | ✅/⚠️/❌ | パフォーマンス、レスポンス速度 |

### antigravity 視点

| カテゴリ | 状態 | 詳細 |
|----------|------|------|
| 技術品質 | ✅/⚠️/❌ | アーキテクチャ整合性、通信フロー |
| セキュリティ | ✅/⚠️/❌ | CSP準拠、XSS対策、最小限permissions |
| ドキュメント | ✅/⚠️/❌ | CLAUDE.mdルール準拠、スキル参照 |
| UX | ✅/⚠️/❌ | 操作の一貫性、エラーメッセージ |

### Claude AI 視点

| カテゴリ | 状態 | 詳細 |
|----------|------|------|
| 技術品質 | ✅/⚠️/❌ | コードの可読性、ロジック明確性 |
| セキュリティ | ✅/⚠️/❌ | 入力サニタイズ、データ検証 |
| ドキュメント | ✅/⚠️/❌ | 命名規則、自己文書化、コメント品質 |
| UX | ✅/⚠️/❌ | ローディング表示、フィードバック |

## 総合評価: PASS / NEEDS REVISION

### 良い点
- {良い点}

### 修正必要項目（NEEDS REVISION の場合）
| # | 優先度 | ファイル:行番号 | 内容 |
|---|--------|----------------|------|
| 1 | 高 | path/to/file:123 | {修正内容} |
```

## 各項目の詳細チェックリスト

### 技術品質
- [ ] Manifest V3 準拠
- [ ] async/await を正しく使用
- [ ] エラーハンドリング実装
- [ ] メモリリークなし
- [ ] 不要なconsole.log削除

### セキュリティ
- [ ] CSP準拠（インラインスクリプト禁止）
- [ ] XSS対策（innerHTMLは要注意）
- [ ] eval()使用禁止
- [ ] 最小限のpermissions
- [ ] 入力値のサニタイズ

### ドキュメント
- [ ] 変数名・関数名が明確
- [ ] 命名規則準拠（camelCase, PascalCase, kebab-case）
- [ ] 必要なコメントあり
- [ ] CLAUDE.mdルール準拠

### UX
- [ ] ローディング表示あり
- [ ] エラーメッセージが理解しやすい
- [ ] 操作が既存機能と一貫
- [ ] レスポンスが十分速い
