<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Remowork Sound Changer</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div class="container">
    <header class="header">
      <h1>Remowork Sound Changer</h1>
    </header>

    <!-- タブナビゲーション -->
    <nav class="tab-nav">
      <button class="tab-btn active" data-tab="sound">🔊 音声</button>
      <button class="tab-btn" data-tab="handsign">👋 検出</button>
      <button class="tab-btn" data-tab="virtual-camera">📷 送信</button>
    </nav>

    <!-- 音声設定タブ -->
    <div class="tab-content active" id="tab-sound">
      <div class="tab-header">
        <span>音声差し替え</span>
        <label class="toggle-switch">
          <input type="checkbox" id="enabled-toggle" checked>
          <span class="slider"></span>
        </label>
      </div>

      <!-- URL設定欄（将来用、現在は無効） -->
      <section class="url-section">
        <label class="section-label">対象URL（将来対応予定）</label>
        <input type="text" class="url-input" value="https://stage.remowork.biz/*" disabled>
        <input type="text" class="url-input" value="https://remowork.biz/*" disabled>
      </section>

      <main class="sound-list" id="sound-list">
        <!-- 動的に生成 -->
      </main>

      <div class="note">上限: 300MB / 10分</div>
    </div>

    <!-- ハンドサイン検出タブ -->
    <div class="tab-content" id="tab-handsign">
      <div class="tab-header">
        <span>ハンドサイン検出</span>
        <label class="toggle-switch">
          <input type="checkbox" id="handsign-enabled-toggle" checked>
          <span class="slider"></span>
        </label>
      </div>

      <section class="handsign-section">
        <label class="section-label">自分の名前（検出対象外）</label>
        <input type="text" class="text-input" id="handsign-myname" placeholder="ページから自動検出します">
      </section>

      <section class="handsign-section">
        <label class="section-label">検出対象</label>
        <div class="radio-group">
          <label class="radio-label">
            <input type="radio" name="detect-target" value="all" checked>
            全員を検出
          </label>
          <label class="radio-label">
            <input type="radio" name="detect-target" value="selected">
            選択したメンバーのみ
          </label>
        </div>
        <div class="member-list" id="member-list" style="display: none;">
          <p class="note">Remoworkページで自動取得されます</p>
        </div>
      </section>

      <section class="handsign-section">
        <label class="section-label">通知設定</label>
        <div class="checkbox-group">
          <label class="checkbox-label">
            <input type="checkbox" id="handsign-toast" checked>
            画面にトースト表示
          </label>
          <label class="checkbox-label">
            <input type="checkbox" id="handsign-sound" checked>
            通知音を鳴らす
          </label>
        </div>
      </section>

      <section class="handsign-section">
        <label class="section-label">通知音の種類</label>
        <select class="sound-mode" id="handsign-sound-preset">
          <!-- 動的に生成される -->
        </select>
        <div class="sound-controls" style="margin-top: 8px;">
          <button class="btn btn-play" id="test-handsign-sound" title="再生">
            <svg class="icon-play" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
              <path d="M8 5v14l11-7z"/>
            </svg>
          </button>
          <label class="btn btn-upload" title="カスタム音声をアップロード">
            <input type="file" accept="audio/*" id="handsign-custom-upload" hidden>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
              <path d="M9 16h6v-6h4l-7-7-7 7h4v6zm-4 2h14v2H5v-2z"/>
            </svg>
          </label>
        </div>
        <div class="sound-file-info" id="handsign-custom-file-info"></div>
      </section>

      <section class="handsign-section">
        <label class="section-label">検出するジェスチャー</label>
        <div class="gesture-list">
          <div class="gesture-item">
            <span class="gesture-emoji">👋</span>
            <span class="gesture-desc">手を開く → 話したそう</span>
          </div>
          <div class="gesture-item">
            <span class="gesture-emoji">👍</span>
            <span class="gesture-desc">サムズアップ → 話してもOK</span>
          </div>
        </div>
      </section>
    </div>

    <!-- 隠しモード: 仮想カメラ設定タブ -->
    <div class="tab-content" id="tab-virtual-camera">
      <div class="tab-header">
        <span>📷 仮想カメラ</span>
      </div>

      <section class="handsign-section">
        <label class="section-label">ハンドサイン画像を撮影・登録（各12枚まで）</label>
        <p class="note" style="margin-bottom: 12px;">撮影ごとにランダムで使用されます！</p>

        <div class="camera-info-box">
          <p>📷 Remoworkサイト上で撮影します</p>
          <p class="note">サイトのカメラ権限を使用するため、<br>ポップアップでは撮影できません</p>
        </div>

        <div class="camera-controls">
          <button class="btn btn-camera-action btn-primary" id="start-camera-btn">📷 撮影モーダルを開く</button>
        </div>
        <canvas id="camera-canvas" style="display: none;"></canvas>
      </section>

      <section class="handsign-section">
        <label class="section-label">👋 登録済み画像 (<span id="wave-count">0</span>/12)</label>
        <div class="registered-images-grid" id="wave-images-grid">
          <!-- 動的に生成 -->
        </div>
        <div class="image-grid-buttons">
          <button class="btn btn-default-images" id="default-wave-btn">デフォルト画像をセット</button>
          <button class="btn btn-danger btn-clear-all" id="clear-wave-btn" style="display: none;">全て削除</button>
        </div>
      </section>

      <section class="handsign-section">
        <label class="section-label">👍 登録済み画像 (<span id="thumbsup-count">0</span>/12)</label>
        <div class="registered-images-grid" id="thumbsup-images-grid">
          <!-- 動的に生成 -->
        </div>
        <div class="image-grid-buttons">
          <button class="btn btn-default-images" id="default-thumbsup-btn">デフォルト画像をセット</button>
          <button class="btn btn-danger btn-clear-all" id="clear-thumbsup-btn" style="display: none;">全て削除</button>
        </div>
      </section>

      <section class="handsign-section">
        <label class="section-label">使い方</label>
        <div class="usage-info">
          <p>1. カメラを起動して、ハンドサインのポーズを撮影</p>
          <p>2. 複数枚登録すると、送信時にランダムで選択</p>
          <p>3. Remoworkページのタイマー横のボタンで送信</p>
          <p>4. 写真が撮られたら自動で通常カメラに戻ります</p>
        </div>
      </section>
    </div>

    <footer class="footer">
      <p class="version">v1.2.0</p>
    </footer>
  </div>

  <template id="sound-item-template">
    <div class="sound-item" data-id="">
      <div class="sound-header">
        <span class="sound-label"></span>
        <span class="sound-status"></span>
      </div>
      <p class="sound-description"></p>
      <div class="sound-controls">
        <select class="sound-mode">
          <option value="original">オリジナル</option>
          <!-- プリセット音声は動的に追加 -->
          <option value="custom">カスタム（アップロード）</option>
        </select>
        <button class="btn btn-play" title="再生">
          <svg class="icon-play" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path d="M8 5v14l11-7z"/>
          </svg>
          <svg class="icon-stop" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="display: none;">
            <path d="M6 6h12v12H6z"/>
          </svg>
        </button>
        <label class="btn btn-upload" title="アップロード">
          <input type="file" accept="audio/*" hidden>
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path d="M9 16h6v-6h4l-7-7-7 7h4v6zm-4 2h14v2H5v-2z"/>
          </svg>
        </label>
      </div>
      <div class="sound-file-info"></div>
    </div>
  </template>

  <audio id="preview-audio" hidden></audio>

  <script src="popup.js"></script>
</body>
</html>
